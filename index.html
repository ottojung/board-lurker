

<body>

  <script>

    async function get_threads(board) {
        var response = await fetch("https://a.4cdn.org/" + board + "/threads.json");
        var json = await response.json();

        var joined = [];

        for (var i = 0; i < json.length; i++) {
            var threads = json[i].threads;
            for (var k = 0; k < threads.length; k++) {
                joined.push(threads[k]);
            }
        }

        return joined;
    }

    async function get_thread_posts(board, thread_id) {
        var response = await fetch("https://a.4cdn.org/" + board + "/thread/" + thread_id.to_string() + ".json");
        var json = await response.json();
        return json.posts;
    }

    async function get_popular_b_threads() {
        var threads = await get_threads("b");
        var popular = threads.filter(thread => thread.replies > 200);
        return popular;
    }

    async function main_loop() {
        var current = await get_popular_b_threads();
        console.log({current});
    }

    function main() {
        main_loop(); // DEBUG
        // main_loop().then(_ => setTimeout(main, 1000));
    }

    main();

  </script>

</body>
